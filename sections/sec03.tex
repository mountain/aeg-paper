\subsection{Flow equation}\label{sec:equation}

Consider an infinitesimal generating process on a Riemannian surface $M$ using two generators:
one for an additional action $\mu$ and the other for a multiplicative action $e^\lambda$.
These two generators are perpendicular.
This generation process produces an assignment $A: M \to R$ over the surface.

For any point with an assignment $a_0$, if we consider a movement of distance $\epsilon$ in a direction with angle $\theta$
over a time period of $\delta$, we can establish the following:

\[
    a_{\delta} = (a_0 + \mu \epsilon \cos \theta)e^{\lambda \epsilon \sin \theta}
\]

or

\[
    a_{\delta} = a_0 e^{\lambda \epsilon \sin \theta} + \mu \epsilon \cos \theta
\]

Both formula can be simplified to the same result:

\[
    a_{\delta} = a_0 + \epsilon (a_0 \lambda \sin \theta + \mu \cos \theta)
\]

Then, we have the following equation:

\[
    \frac{1}{\delta} (a_{\delta} - a_0) = \frac{\epsilon}{\delta} (\mu \cos \theta + x_0 \lambda \sin \theta)
\]

When both $\delta$ and $\epsilon$ are towards zero, we get $da / dt$, and hence

\[
    \frac{da}{dt} = u (\mu \cos \theta + a \lambda \sin \theta)
\]

Or, we can change it to another form

\begin{equation}
    \frac{da}{ds} = \mu \cos \theta + a \lambda \sin \theta\label{eq:flow}
\end{equation}

We name this equation~\eqref{eq:flow} as the flow equation.

The left side of this equation is governed by the distance structure, while the right side is governed by the angle structure.
This leads to below theorem.

\begin{theorem}
Isometries keep the flow equation\eqref{eq:flow}
\label{thm:isometry}
\end{theorem}

\begin{proof}
  An isometry keeps both the distance structure and the angle structure, so it keeps the flow equation.
\end{proof}

We can also get a direct formal solution of the flow equation~\eqref{eq:flow}(details in Appendix~\ref{sec:directformalsolution}).

\begin{equation}
   a = (a_0 + \frac{\mu}{\lambda} \cot \theta) e^{\lambda s \sin \theta} - \frac{\mu}{\lambda} \cot \theta\label{eq:solution}
\end{equation}

Now, we can use this solution to derive (details in Appendix~\ref{sec:conformance}) the relationship between assignments at different vertices in a cell of a mesh grid.

Assuming the assignment at the center point of a cell is $a_0$, we move in different directions and obtain the following assignments:

\begin{itemize}
\item $\theta = 0$: $a_s = a_0 + \mu s$
\item $\theta = \frac{\pi}{2}$: $a_s = a_0 e^{\lambda s}$
\item $\theta = \pi$: $a_s = a_0 - \mu s$
\item $\theta = \frac{3 \pi}{2}$: $a_s = a_0 e^{- \lambda s} $
\end{itemize}

This result is straightforward, but it demonstrates that the infinitesimal generating process is consistent with the discrete mesh grid.

\subsection{The contour-gradient form of flow equation}\label{subsec:the-contour-gradient-form}

It is easy to derive the contour equation in the local coordinate

\begin{equation}
    \mu \cos \theta_c + a \lambda \sin \theta_c = 0\label{eq:contour}
\end{equation}

then we have

\begin{equation}
    \theta_c = - \arctan \frac{\mu}{a \lambda}\label{eq:contourangle}
\end{equation}

the contour and the gradient are perpendicular to each other

\begin{equation}
    \theta_g = \pm \frac{\pi}{2} - \arctan \frac{\mu}{a \lambda}\label{eq:gradientangle}
\end{equation}

then along $\theta_g$ we have

\begin{equation}
    \frac{da}{ds} = \mu \cos (\pm \frac{\pi}{2} - \arctan \frac{\mu}{a \lambda}) + a \lambda \sin (\pm \frac{\pi}{2} - \arctan \frac{\mu}{a \lambda})
    \label{eq:alonggradient}
\end{equation}

\begin{equation}
    \frac{da}{ds} = \pm \sqrt{\mu^2 + \lambda^2 a^2}\label{eq:grad}
\end{equation}

By introducing the right-hand rotation angle $\phi$ along the gradient direction, we can establish a local polar coordinate system based on the gradient and contour lines.
Then the growth rate of $a$ along the angle $\phi$ is

\begin{equation}
    \frac{da}{ds} = \mu \cos (\frac{\pi}{2} - \arctan \frac{\mu}{a \lambda} + \phi) + a \lambda \sin (\frac{\pi}{2} - \arctan \frac{\mu}{a \lambda} + \phi)
    \label{eq:fourfold}
\end{equation}

And the simplified equation is

\begin{equation}
    \frac{da}{ds} = \sqrt {\mu^2 + a^2 \lambda^2} \cos \phi\label{eq:contourgradient}
\end{equation}

or

\begin{equation}
    \frac{da_{\phi}}{ds_{\phi}} = \sqrt {\mu^2 + a^2 \lambda^2} \cos \phi\label{eq:contourgradient2}
\end{equation}

if we want to emphasize the path is along the angle $\phi$.

The equation~\eqref{eq:contourgradient} is the flow equation in the contour-gradient coordinate system.

Equation~\eqref{eq:contourgradient} is solvable, and we get the relation between $a$ and $s$:

\begin{equation}\label{eq:rel_a_s}
    \tanh(\lambda s \cos \phi - c) = \frac{\lambda a}{\sqrt{\mu^2 + \lambda^2 a^2}}
\end{equation}

we can further simplify the equation to

\begin{equation}
  a = \pm \frac{\mu}{\lambda} \sinh(\lambda s \cos \phi - c)\label{eq:gradevo}
\end{equation}

Under the initial condition $a = a_0$ when $s = 0$, we can get the following equation:

\begin{equation}
    a = \frac{\mu}{\lambda} \sinh(\lambda s \cos \phi + \arcsinh \frac{a_0 \lambda}{\mu})\label{eq:gradevo2}
\end{equation}

or

\begin{equation}
    a = - \frac{\mu}{\lambda} \sinh(\lambda s \cos \phi - \arcsinh \frac{a_0 \lambda}{\mu})\label{eq:gradevo3}
\end{equation}

In this coordinate system, the additional line and the multiplicative line are:

\begin{equation}
    \phi = \arccos \frac{\mu}{\sqrt {\mu^2 + a^2 \lambda^2}} \label{eq:additionalline}
\end{equation}

\begin{equation}
    \phi = \arcsin \frac{\mu}{\sqrt {\mu^2 + a^2 \lambda^2}}\label {eq:mulitiplcativeline}
\end{equation}

\subsection{Local Descartes coordinate and area formula}\label{subsec:descartes-coordinate}
We begin our exploration by examining the flow equation~\eqref{eq:flow} within the framework of a local polar coordinate system:

\begin{equation}
    \frac{da}{ds} = \mu \cos \theta + a \lambda \sin \theta
\end{equation}

In an effort to recontextualize this equation, we set $dx = \cos \theta ds$ and $dy = \sin \theta ds$,
thereby enabling us to express it in a different light:

\begin{equation}
    da = \mu dx + a \lambda dy
\end{equation}

Our attention now turns to the concept of arithmetic torsion, particularly at an infinitesimal level. Delving into the interplay between two infinitesimal generating processes, we observe that:

\begin{equation}
    d\tau = a_0 e^{\lambda dy} + \mu dx - (a_0 + \mu dx) e^{\lambda dy}
\end{equation}

From this relationship, we deduce:

\begin{equation}
    d\tau = \mu dx (1 - e^{\lambda dy})
\end{equation}

This leads us to an intriguing area formula, capturing the essence of this interaction:

\begin{equation}
    d\tau = - \mu \lambda dx dy \label{eq:area_formula}
\end{equation}

or in the form of a differential form:
\begin{equation}
    d\tau = - \mu \lambda dS \label{eq:area_formula2}
\end{equation}

where $dS$ is the area element.

This formula is interesting because it connects the area elements and arithmetic torsion which by nature are defined on edge of the area.

These kind of formulas are also meet in the study of classic analysis or differential geometry, for example, Stokes theorem or the Gauss-Bonnet theorem.
We will develop this formula further in the following section\ref{sec:curvature} to connect it with curvature and the Gauss-Bonnet theorem.

\subsection{Flow and function}\label{subsec:flow-and-function}

In this section, we aim to present novel insight into functions.
Namely, the treatment of functions as flows will be discussed.

\begin{definition}\label{def:projection}
Given a function $k$ on the real domain $R$, we can introduce a mapping $l$ on the arithmetic expression space $H$ such that the following diagram commutes.

\begin{center}
    \begin{tikzcd}
        H && H \\
        R && R
        \arrow["l", from=1-1, to=1-3]
        \arrow["\nu"', from=1-1, to=2-1]
        \arrow["\nu", from=1-3, to=2-3]
        \arrow["k"', from=2-1, to=2-3]
    \end{tikzcd}
\end{center}

where $\nu$ is the evaluation function of the expression. Then we call the mapping $l$ is the promotion of the function $k$,
or function $k$ is the projection of the mapping $l$.
\end{definition}

Giving an arithmetic expression space as definition at the beginning of the section\ref{subsec:meshgrid},
we will show examples of flows as functions.

\subsubsection{Example: Brachistochrone curve}\label{subsubsec:brachistochrone}

The brachistochrone curve is the curve between two points that minimizes the time taken by a frictionless bead sliding along a wire.
We assume the wire is a curve $\eta = f(\delta)$, and the bead starts at $(0, 0)$ and ends at $( \Delta, H )$ as time $t$ goes from $0$ to $T$.

TODO

\subsection{The existence theorems}\label{subsec:existence-theorems}

There are two important existence theorems related to the flow equation~\eqref{eq:flow}.

The first existence theorem states that if we have a 2D Riemannian manifold $M$, then there exists a function $a$ on $M$ that satisfies the flow equation~\eqref{eq:flow}. This theorem is proved in a later section, and we will not go into the details of the proof here.

\begin{theorem}
    Given a 2D Riemannian manifold $M$, there exists a function $a$ on $M$ satisfying the flow equation~\eqref{eq:flow}.
    \label{prop:existence1st}
\end{theorem}

The second existence theorem is also crucial.
It says that if we have a smooth surface $S$ and a function $a$ on $S$, then we can find a metric $g$ on $S$ that makes $a$ satisfy the flow equation~\eqref{eq:flow}.
We morph the metric $g$ to make $a$ satisfy the flow equation~\eqref{eq:flow}, this technique will be touched back and forth in the following sections.

\begin{theorem}(By Le Zhang)
    Given an oriented 2D compact Riemannian manifold $S$, and a function $a$ over $S$, there exists a metric $g$ on $S$ that makes $a$
    satisfying the flow equation~\eqref{eq:flow}.
    \label{prop:existence2nd}
\end{theorem}

\begin{proof}

    The proof is divided into two parts: local perspective and global perspective.

    \emph{Local perspective}:

    Consider a point \( p \) on the surface \( S \), and there is a neighborhood \( U \) around \( p \).
    In this area, we can find a local isothermal coordinate system in which the metric takes the form:
    \[ ds^2 = e^{2\rho}(du^2 + dv^2), \]
    where \( u \) and \( v \) are the coordinates of \( U \), and \( \rho \) is a function of \( u, v \) in \( U \).
    The gradient of \( a \) in this local isothermal coordinate system is expressed as:
    \[ \nabla a = \frac{\partial a}{\partial u} du + \frac{\partial a}{\partial v} dv. \]
    Using the definition of the directional derivative, we obtain:
    \[ \frac{da_{\psi}}{ds_{\psi}} = ||\nabla a|| \cos \psi, \]
    where \( ||\nabla a|| \) is the norm of \( \nabla a \), and \( \psi \) is the angle between \( \nabla a \) and the direction of movement.

    Now, considering the flow equation~\ref{eq:contourgradient2} in the gradient-contour coordinate system, we have:
    \[ \frac{da_{\phi}}{ds_{\phi}} = \sqrt{\mu^2 + a^2 \lambda^2} \cos \phi. \]

    Note that \( ||\nabla a|| \) is fixed for the given function \( a \) and the local coordinate system, and \( \sqrt{\mu^2 + a^2 \lambda^2} \) is also fixed for the given function \( a \).
    We can scale \( e^{2\rho} \) with a linear factor \( \kappa \) to make \( ||\nabla a|| \) match the fixed value of \( \sqrt{\mu^2 + a^2 \lambda^2} \),
    thus we have a morphing process controlled by \( \kappa \) that
    \begin{align}
    ds^2 &= \kappa e^{2 \rho}(du^2 + dv^2)\label{eq:morphing} \\
         &= e^{2 \rho + \ln \kappa}(du^2 + dv^2).
    \end{align}

    Under the morphing ratio \( \kappa \), we have:

    \begin{equation}
      ||\nabla_\kappa a|| = \kappa^{-1} ||\nabla a||,
    \end{equation}

    and when \( \kappa \) is set to the value of:

    \[ ||\nabla_\kappa a|| = \sqrt{\mu^2 + a^2 \lambda^2}, \]

    the flow equation~\eqref{eq:flow} is satisfied in the local coordinate system.

    The morphing ratio \( \kappa \) is calculated as follows:
    \begin{equation}
        \kappa = \frac{||\nabla a||}{\sqrt{\mu^2 + a^2 \lambda^2}}\label{eq:ratio}.
    \end{equation}

    \emph{Global perspective}:

    When we consider the broader scope of the surface \( S \), it's possible to extend the morphing process to every point,
    ensuring that the flow equation~\eqref{eq:flow} is satisfied on a global scale.
    However, this expansion necessitates a harmonious integration of the morphing process across neighboring locales.
    Specifically, this means that the morphing should not only preserve the circles centered at point \( p \) within its immediate local chart
    but also maintain the integrity of these circles within the adjacent charts of point \( p \).
    In essence, the morphing process must be seamlessly coordinated across the various local regions to achieve a unified global transformation.

    TODO

    \qedhere
\end{proof}
